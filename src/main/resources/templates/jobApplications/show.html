<!DOCTYPE html>
<html lang="en">
<head th:replace="partials/head :: head ('Job Application')"/>
<body class="container row justify-content-evenly">
<th:block th:replace="partials/navbar :: navbar"></th:block>
<!--this is for the modal, it does work but get the edit note function working first before having all these forms moved around to work within the modal-->
<!--<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#showJobApp">Show Job App</button>-->

<!--<div class="modal fade modal-dialog modal-lg" id="showJobApp">-->
    <!--  LEFT SIDE-->
    <div class="card text-center col-8 mt-5 p-4">
        <!--  JOB INFO-->
        <div class="align-items-center">
            <img th:src="'//logo.clearbit.com/' + ${jobApp.company} + '.com?size=40'">
        </div>
        <h6 class="text-primary card-title" th:text="${jobApp.title}"></h6>
        <p th:text="${jobApp.description}"></p>
        <div class="d-flex">
            Location: <p th:text="${jobApp.location}" class="fw-bold"></p>
        </div>
        <div class="d-flex">
            Salary: <p th:text="'$' + ${jobApp.salary}" class="fw-bold"></p>
        </div>
        <div class="d-flex">
            Company: <p class="card-text fw-bold" th:text="${jobApp.company}"></p>
        </div>

        <form th:action="@{/notes/{id}/create(id = ${jobApp.getId()})}" method="post" th:object="${note}">
            <button type="button" class="btn-small btn-primary" data-bs-toggle="modal" data-bs-target="#createNote">Create a note</button>
            <div th:replace="/notes/create.html :: #createNote"></div>
        </form>

<!--        pre change up-->
<!--        <form th:action="@{/notes/{id}/create(id = ${jobApp.getId()})}" method="post" th:object="${note}">-->
<!--            <button type="button" class="btn-small btn-primary" data-bs-toggle="modal" data-bs-target="#createNote">-->
<!--                Create a note-->
<!--            </button>-->
<!--            <div th:replace="/notes/create.html :: #createNote"></div>-->
<!--        </form>-->
        <!--  NOTES CARD-->
        <div class="card" th:each="note : ${notes}">
            <p class="col-3" th:text="${#dates.format(note.date, 'dd-MM-yyyy')}"></p>
            <h5 th:text="${note.title}"></h5>
            <p th:text="${note.content}"></p>
            <!-- BUTTONS-->
            <div class="d-flex justify-content-end">
                <form th:action="@{/notes/{id}/edit/{jobId}(id = ${note.id}, jobId = ${jobApp.getId()})}"
                      method="post" th:object="${note}">
                    <button type="button" class="btn-small btn-primary" data-bs-toggle="modal"
                            data-bs-target="#editNote">Edit Note
                    </button>
                    <div th:replace="/notes/edit.html :: #editNote"></div>
                </form>
                <form th:action="@{/notes/delete/{id}(id = ${note.id})}" method="post">
                    <button type="button" class="btn-small btn-danger">Delete Note</button>
                </form>
            </div>
        </div>
    </div>
    <!--  RIGHT SIDE OF PAGE / BUTTONS -->
    <div th:if="${isJobOwner}" class="col-2 mt-5">
        <form th:action="@{/jobApplications/{id}/edit(id=${jobApp.id})}" method="get" class="m-3">
            <button>Edit Job</button>
        </form>
        <form th:action="@{/jobApplications/{id}/delete(id=${jobApp.id})}" method="post" class="m-3">
            <button>Delete Job</button>
        </form>
    </div>
<!--</div>-->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>
</html>